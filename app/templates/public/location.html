{% extends "layout/base.html" %}
{% block title %}Location — The Mine 606{% endblock %}
{% block content %}
<section class="max-w-6xl mx-auto px-4 pt-14 pb-24">
  <header class="mb-6 sm:mb-8">
    <h1 class="font-serif text-3xl sm:text-4xl md:text-5xl">Find Us</h1>
    <p class="text-white/70 mt-2 text-sm sm:text-base">Across from Appalachian Wireless Arena.</p>
  </header>

  <div class="grid lg:grid-cols-2 gap-4 sm:gap-6">
    <div class="card overflow-hidden">
      {% set lat = site.lat if site else None %}
      {% set lng = site.lng if site else None %}
      {% if GOOGLE_MAPS_API_KEY and lat and lng %}
        <!-- JS map could be added later; for now, embed with coords -->
        <iframe
          title="Map"
          class="w-full h-64 sm:h-80"
          loading="lazy"
          src="https://www.google.com/maps/embed/v1/view?key={{ GOOGLE_MAPS_API_KEY }}&center={{ lat }},{{ lng }}&zoom=16&maptype=roadmap">
        </iframe>
      {% else %}
        <!-- Fallback: Mine 606 location -->
        <iframe
          title="Map"
          class="w-full h-64 sm:h-80"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
          src="https://www.google.com/maps?q=The%20Mine%20606%2C%20121%20Main%20St%2C%20Pikeville%2C%20KY&output=embed">
        </iframe>
      {% endif %}
    </div>

    <div class="card p-4 sm:p-5">
      <div class="font-semibold">Hours</div>
      <div class="mt-2 text-white/80 text-sm">
        {% if template_globals(request).get('HOURS_HTML') %}
          {{ template_globals(request).get('HOURS_HTML')|safe }}
        {% else %}
          Tue–Thu 11am–10pm<br>
          Fri–Sat 11am–12am<br>
          Sun 11am–9pm<br>
          Mon Closed
        {% endif %}
      </div>

      <div class="mt-6 font-semibold">Contact</div>
      <div class="text-white/80 text-sm">
        {{ site.email if site and site.email else 'mine606@example.com' }}
        •
        {{ site.phone if site and site.phone else '(555) 555-0606' }}
      </div>
      {% if site and site.address %}
      <div class="text-white/80 text-sm mt-2">
        {{ site.address }}{% if site.city %}, {{ site.city }}{% endif %}{% if site.state %}, {{ site.state }}{% endif %}{% if site.zip %} {{ site.zip }}{% endif %}
      </div>
      {% endif %}

      <form id="contactForm" class="mt-6 space-y-4">
        <input name="name" placeholder="Your name" class="input" required>
        <input type="email" name="email" placeholder="you@example.com" class="input" required>
        <textarea name="message" placeholder="Message" rows="4" class="input resize-vertical" required></textarea>
        <button type="submit" class="btn-secondary w-full sm:w-auto">Send Message</button>
        <div id="contactMsg" class="text-white/70 text-sm"></div>
      </form>
    </div>
  </div>
</section>

{% block body_scripts %}
<script src="/static/js/forms.js"></script>
<script>
setupAjaxForm({
  formId: 'contactForm',
  endpoint: '/api/contact',
  successText: 'Thanks! We’ll get back to you soon.',
  errorText: 'Message failed — please try again.'
});
</script>
{% endblock %}
{% endblock %}
